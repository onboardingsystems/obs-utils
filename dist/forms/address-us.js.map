{"version":3,"sources":["address-us.js"],"names":[],"mappings":"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","file":"dist/forms/address-us.js","sourcesContent":["const React = require('react')\nconst cx    = require('classnames')\nconst _     = require('lodash')\n\nconst Formatters = require('../formatters/formatters')\n\nconst ObsCompoundLayout = require('./compound-layout')\nconst ObsFormattedText  = require('./formatted-text')\nconst ObsLabel          = require('./label')\nconst ObsHint           = require('./hint')\nconst ObsError          = require('./error')\n\nconst ObsAddressUs = React.createClass({\n  propTypes: {\n    object:       React.PropTypes.object.isRequired,\n    attr:         React.PropTypes.string.isRequired,\n    onChange:     React.PropTypes.func,\n    onErrorChange:React.PropTypes.func,\n    // field was \"touched\" by user. Requires a change.\n    onTouch:      React.PropTypes.func,\n    // errors are an object here (covers multiple fields)\n    errors:       React.PropTypes.object,\n    label:        React.PropTypes.string,\n    hint:         React.PropTypes.string,\n    required:     React.PropTypes.bool,\n    className:    React.PropTypes.string,\n  },\n\n  fields: {\n    street_1: {name: 'Address', attr: 'street_1'},\n    city:     {name: 'City',    attr: 'city'},\n    state:    {name: 'State',   attr: 'state'},\n    zip:      {name: 'Zip',     attr: 'zip'}\n  },\n\n  getDefaultProps() {\n    return {\n      label: \"Address\"\n    }\n  },\n\n  getInitialState() {\n    return {\n      addressId: _.uniqueId('address1_'),\n      errors: this._addressErrors(this.props.errors)\n    }\n  },\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({errors: this._addressErrors(nextProps.errors)})\n  },\n\n  _address_attrs() {\n    var list = []\n    _.forOwn(this.fields, (field, value)=> {\n      list.push(this._fullAttrName(value.attr))\n    })\n    return list\n  },\n\n  _addressErrors(errors) {\n    var fullAttrErrors, result = {}\n    // turn fully-qualified errors structure into one that\n    // is only relevant for this context for the defined fields.\n    // {\n    //   \"person.address.state\": [\"is required\"]\n    // }\n    //\n    // Convert to format:\n    //\n    // {\n    //   \"state\": [\"is required\"]\n    // }\n    fullAttrErrors = _.pick(errors, this._address_attrs())\n    // loop through all the defined fields and look for any fully qualified\n    // errors for it. If found, add then to the result object with the local\n    // attr path.\n    _.forOwn(this.fields, (value, field)=> {\n      var errors\n      errors = fullAttrErrors[this._fullAttrName(value.attr)]\n      if (!_.isEmpty(errors))\n        result[value.attr] = errors\n    })\n    return result\n  },\n\n  _getErrors(attr) {\n    return this.state.errors[attr]\n  },\n\n  _anyChildErrors() {\n    return !_.isEmpty(this.state.errors)\n  },\n\n  _fullAttrName(attr) {\n    return `${this.props.attr}.${attr}`\n  },\n\n  _errorsText() {\n    var list = []\n    _.forEach(this.state.errors, (errors, field)=> {\n      _.forEach(errors, (error)=> {\n        list.push(`${this.fields[field].name} ${error}`)\n      })\n    })\n    return list\n  },\n\n  _valueChanged(attr, newVal) {\n    // Fire onChange event for the full attribute name and the updated value.\n    if (_.isFunction(this.props.onChange))\n      this.props.onChange(this._fullAttrName(attr), newVal)\n  },\n\n  _fieldTouched(attr) {\n    if (_.isFunction(this.props.onTouch))\n      this.props.onTouch(this._fullAttrName(attr))\n  },\n\n  _errorsChanged(attr, errors) {\n    var newErrors\n    // update the errors state. start with existing, remove resolved errors and\n    // add new ones.\n    newErrors = this.state.errors\n    if (_.isEmpty(errors))\n      delete newErrors[attr]\n    else\n      newErrors[attr] = errors\n    this.setState({errors: newErrors})\n    // if have onErrorChange event, convert errors back to global version and\n    // fire update\n    if (_.isFunction(this.props.onErrorChange))\n      this.props.onErrorChange(this._fullAttrName(attr), errors)\n  },\n\n  render() {\n    var addrObject, classes\n    addrObject = _.get(this.props.object, this.props.attr) || {}\n\n    classes = cx({\n      'address-us': true,\n      'address-us': true,\n      'form-group': true,\n      'has-child-error': this._anyChildErrors(),\n      [ this.props.className ]: true\n    })\n\n    return (\n      <div className={classes}>\n        <ObsLabel text={this.props.label} required={this.props.required} htmlFor={this.state.addressId} />\n        <ObsHint  hint={this.props.hint} />\n        <ObsCompoundLayout label={this.props.label} layout={\"full\"} className={this.props.className}>\n          <ObsFormattedText id={this.state.addressId}\n            object={addrObject} attr={this.fields.street_1.attr} formatter={Formatters.stringFormatter}\n            required={this.props.required} errors={this._getErrors(this.fields.street_1.attr)}\n            placeholder={\"Address\"} onErrorChange={this._errorsChanged}\n            onChange={_.bind(this._valueChanged, this)} className=\"address-line-1\"\n            onTouch={this._fieldTouched} />\n\n          <ObsCompoundLayout label={this.props.label} layout={\"inline\"} className={this.props.className}>\n            <div className=\"flex-grow-shrink\">\n              <ObsFormattedText object={addrObject} attr={this.fields.city.attr} formatter={Formatters.stringFormatter}\n                required={this.props.required} errors={this._getErrors(this.fields.city.attr)}\n                placeholder={\"City\"} onErrorChange={this._errorsChanged}\n                onChange={_.bind(this._valueChanged, this)} className=\"address-city\"\n                onTouch={this._fieldTouched} />\n            </div>\n            <div className=\"flex-static\">\n              <ObsFormattedText object={addrObject} attr={this.fields.state.attr} formatter={Formatters.stateFormatter}\n                required={this.props.required} errors={this._getErrors(this.fields.state.attr)}\n                placeholder={\"ST\"} onErrorChange={this._errorsChanged}\n                onChange={_.bind(this._valueChanged, this)} className=\"address-state state\"\n                onTouch={this._fieldTouched} />\n            </div>\n            <div className=\"flex-static\">\n              <ObsFormattedText object={addrObject} attr={this.fields.zip.attr} formatter={Formatters.zipcodeFormatter}\n                required={this.props.required} errors={this._getErrors(this.fields.zip.attr)}\n                placeholder={\"Zip\"} onErrorChange={this._errorsChanged}\n                onChange={_.bind(this._valueChanged, this)} className=\"address-zipcode zipcode\"\n                onTouch={this._fieldTouched} />\n            </div>\n          </ObsCompoundLayout>\n        </ObsCompoundLayout>\n        <ObsError errors={this._errorsText()} />\n      </div>\n    )\n  }\n})\n\nmodule.exports = ObsAddressUs\n"]}